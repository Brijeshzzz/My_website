<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SYSTEM_CRITICAL</title>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Poppins:wght@300;600&display=swap" rel="stylesheet">
    <style>
        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            background: #000; overflow: hidden;
            font-family: 'Courier New', monospace;
            cursor: none; user-select: none;
        }

        /* --- 3D CANVAS (Scary Tunnel) --- */
        #warp-canvas {
            position: absolute; top: 0; left: 0;
            z-index: 1; filter: contrast(150%) brightness(1.5);
        }

        /* --- UI LAYER (SCARY) --- */
        #ui-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 10; display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            pointer-events: none;
        }

        /* FAKE WEBCAM REC */
        #rec-overlay {
            position: absolute; top: 20px; left: 20px; color: red;
            font-weight: bold; font-size: 1.5rem; display: none;
            z-index: 200; text-shadow: 0 0 10px red;
            animation: blink 1s infinite;
        }
        @keyframes blink { 50% { opacity: 0; } }

        /* START BUTTON */
        #start-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 100;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer;
        }
        #btn {
            border: 4px solid red; padding: 20px 60px;
            color: red; font-size: 2rem; letter-spacing: 5px;
            background: black; transition: 0.2s;
            box-shadow: 0 0 30px red; text-transform: uppercase;
            font-weight: bold; animation: pulse-btn 1s infinite;
        }
        #btn:hover { background: red; color: black; }
        @keyframes pulse-btn { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }

        /* SCARY TEXT */
        .glitch-text {
            font-size: 5rem; color: red; font-weight: bold;
            text-shadow: 5px 5px 0px #330000;
            animation: shake-text 0.1s infinite; display: none;
            background: rgba(0,0,0,0.8); padding: 20px; border: 2px solid red;
        }
        
        #ip-display {
            position: absolute; bottom: 80px; color: red; 
            font-size: 1.5rem; background: black; padding: 10px;
            border: 2px solid red; display: none;
        }

        /* DELETING FILES BAR */
        #delete-bar-container {
            position: absolute; bottom: 20px; width: 80%; height: 30px;
            border: 2px solid red; display: none; background: #220000;
        }
        #delete-bar-fill { width: 0%; height: 100%; background: red; transition: width 0.1s; }
        #delete-text { position: absolute; top: -30px; left: 0; color: red; font-weight: bold; }

        /* --- CHAOS TERMINALS --- */
        .terminal-popup {
            position: absolute; background: #000; border: 4px solid red;
            color: red; font-family: 'Lucida Console', monospace;
            z-index: 90; padding: 5px;
            box-shadow: 5px 5px 0px rgba(255,0,0,0.5);
            overflow: hidden; font-weight: bold; font-size: 1rem;
            animation: appear-flash 0.1s;
        }
        @keyframes appear-flash { 0% { opacity: 0; transform: scale(1.2); } 100% { opacity: 1; transform: scale(1); } }

        /* ========================================= */
        /* --- THE ULTIMATE TECH ENDING STYLES --- */
        /* ========================================= */
        #funny-layer {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #050505; /* Deep Black */
            z-index: 200; flex-direction: column;
            align-items: center; justify-content: center;
            font-family: 'Poppins', sans-serif; cursor: auto;
            opacity: 0; transition: opacity 1s ease-in;
            overflow: hidden;
        }

        /* Neural Network Canvas Background */
        #tech-bg-canvas {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 201; opacity: 0.3;
        }

        .tech-card {
            position: relative; z-index: 210;
            background: rgba(10, 20, 30, 0.7);
            backdrop-filter: blur(15px);
            padding: 50px;
            border-radius: 20px;
            border: 1px solid rgba(0, 255, 200, 0.3);
            box-shadow: 0 0 50px rgba(0, 255, 200, 0.1);
            text-align: center;
            display: flex; flex-direction: column; align-items: center;
            max-width: 600px;
            animation: card-float 6s ease-in-out infinite;
        }
        @keyframes card-float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        /* Avatar Radar Effect */
        .avatar-box {
            position: relative; width: 130px; height: 130px;
            border-radius: 50%; margin-bottom: 20px;
            display: flex; align-items: center; justify-content: center;
        }
        .avatar-box img {
            width: 120px; height: 120px; border-radius: 50%; z-index: 2;
            border: 3px solid #00ffcc;
        }
        .radar-sweep {
            position: absolute; width: 100%; height: 100%;
            border-radius: 50%; border: 2px solid rgba(0, 255, 204, 0.5);
            animation: radar-spin 2s linear infinite;
        }
        .radar-sweep::before {
            content: ''; position: absolute; top: 0; left: 50%;
            width: 50%; height: 50%;
            background: linear-gradient(90deg, rgba(0,255,204,0.5), transparent);
            transform-origin: bottom left;
        }
        @keyframes radar-spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Typewriter Text */
        .console-text {
            font-family: 'Share Tech Mono', monospace;
            color: #00ffcc; font-size: 1.5rem;
            border-right: 2px solid #00ffcc;
            white-space: nowrap; overflow: hidden;
            width: 0; margin-bottom: 10px;
            animation: typing 3s steps(30, end) forwards, blink-cursor 0.75s step-end infinite;
        }
        @keyframes typing { from { width: 0; } to { width: 100%; } }
        @keyframes blink-cursor { from, to { border-color: transparent; } 50% { border-color: #00ffcc; } }

        .sub-msg { color: #aaa; font-weight: 300; margin-bottom: 30px; }

        /* Floating 2D Tech Symbols */
        .floating-icon {
            position: absolute; font-size: 2rem; color: rgba(0, 255, 204, 0.2);
            animation: float-icon 4s ease-in-out infinite; z-index: 205;
            font-family: monospace; font-weight: bold;
        }
        @keyframes float-icon {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(10px, -20px) rotate(10deg); }
        }

        /* Tech Button */
        .cyber-btn {
            background: transparent; border: 2px solid #00ffcc;
            color: #00ffcc; padding: 15px 40px; font-size: 1.1rem;
            font-family: 'Share Tech Mono', monospace;
            cursor: pointer; position: relative; overflow: hidden;
            transition: 0.3s; text-decoration: none; display: inline-block;
        }
        .cyber-btn:hover { background: #00ffcc; color: #000; box-shadow: 0 0 20px #00ffcc; }
        
        /* Shaking for scare */
        .shaking-body { animation: violent-shake 0.1s infinite; }
        .strobe-bg { animation: strobe 0.1s infinite; }
        @keyframes violent-shake { 0% { transform: translate(0, 0); } 25% { transform: translate(-10px, 10px); } 50% { transform: translate(10px, -10px); } 75% { transform: translate(-10px, -10px); } 100% { transform: translate(0, 0); } }
        @keyframes strobe { 0% { background: black; } 50% { background: #300; } 100% { background: black; } }

    </style>
</head>
<body>

    <div id="start-screen" onclick="startPrank()">
        <div id="btn">INITIATE SEQUENCE</div>
    </div>

    <canvas id="warp-canvas"></canvas>

    <div id="rec-overlay">ðŸ”´ REC [LIVE]</div>

    <div id="ui-layer">
        <div class="glitch-text" id="main-text">SYSTEM OVERLOAD</div>
        <div id="ip-display">GEOLOCATION LOCKED...</div>
        <div id="delete-bar-container">
            <div id="delete-text">DELETING C:/WINDOWS/SYSTEM32...</div>
            <div id="delete-bar-fill"></div>
        </div>
    </div>

    <div id="funny-layer">
        <canvas id="tech-bg-canvas"></canvas>
        
        <div class="floating-icon" style="top:20%; left:20%; animation-delay:0s;">&lt;/&gt;</div>
        <div class="floating-icon" style="top:70%; left:80%; animation-delay:1s;">{ }</div>
        <div class="floating-icon" style="top:10%; right:15%; animation-delay:2s;">;</div>
        <div class="floating-icon" style="bottom:15%; left:30%; animation-delay:1.5s;">01</div>
        <div class="floating-icon" style="top:50%; right:10%; animation-delay:0.5s;">#</div>

        <div class="tech-card">
            <div class="avatar-box">
                <div class="radar-sweep"></div>
                <img src="https://cdn-icons-png.flaticon.com/512/4333/4333609.png" alt="Tech Avatar">
            </div>
            
            <div class="console-text">console.log("Sorry! Wrong Link!");</div>
            
            <p class="sub-msg">
                I think U clicked the wrong button...<br>
                Your system is safe. It was just a simulation.
            </p>

            <a href="structure.html" class="cyber-btn">
                [ ACCESS_MY_PROFILE ]
            </a>
        </div>
    </div>

    <script>
        // --- CONFIG ---
        const startScreen = document.getElementById('start-screen');
        const funnyLayer = document.getElementById('funny-layer');
        const mainText = document.getElementById('main-text');
        const ipDisplay = document.getElementById('ip-display');
        const deleteContainer = document.getElementById('delete-bar-container');
        const deleteFill = document.getElementById('delete-bar-fill');
        const recOverlay = document.getElementById('rec-overlay');
        
        let audioCtx;
        let oscillators = [];
        let escapeCount = 0;
        let animationId;
        let heartRate = 1000; 
        let heartInterval;
        let chaosInterval; 
        let deleteInterval;
        
        // --- 1. THE RED 3D TUNNEL (CANVAS) ---
        const canvas = document.getElementById('warp-canvas');
        const ctx = canvas.getContext('2d');
        let width, height;
        let stars = [];
        const numStars = 1500; 
        const speed = 40; 

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            ctx.translate(width/2, height/2);
        }
        window.addEventListener('resize', resize);

        class Star {
            constructor() {
                this.x = (Math.random() - 0.5) * width * 2;
                this.y = (Math.random() - 0.5) * height * 2;
                this.z = Math.random() * width;
                this.pz = this.z;
            }
            update() {
                this.z = this.z - speed;
                if (this.z < 1) {
                    this.z = width;
                    this.x = (Math.random() - 0.5) * width * 2;
                    this.y = (Math.random() - 0.5) * height * 2;
                    this.pz = this.z;
                }
            }
            show() {
                let sx = (this.x / this.z) * width;
                let sy = (this.y / this.z) * height;
                let px = (this.x / this.pz) * width;
                let py = (this.y / this.pz) * height;
                this.pz = this.z;
                ctx.beginPath();
                ctx.moveTo(sx, sy);
                ctx.lineTo(px, py);
                ctx.strokeStyle = "#ff0000"; 
                ctx.lineWidth = (1 - this.z / width) * 6; 
                ctx.stroke();
            }
        }
        resize();
        for(let i=0; i<numStars; i++) stars.push(new Star());
        function animateTunnel() {
            ctx.fillStyle = "rgba(0, 0, 0, 0.5)"; 
            ctx.fillRect(-width/2, -height/2, width, height);
            stars.forEach(star => { star.update(); star.show(); });
            animationId = requestAnimationFrame(animateTunnel);
        }

        // --- 2. AUDIO ENGINE ---
        function playBeat() {
            if(!audioCtx) return;
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'triangle';
            osc.frequency.setValueAtTime(60, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(30, audioCtx.currentTime + 0.1);
            gain.gain.setValueAtTime(1, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.1);
        }
        function startHeartbeat() {
            if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            function beat() {
                playBeat();
                heartRate = Math.max(80, heartRate - 60); 
                heartInterval = setTimeout(beat, heartRate);
            }
            beat();
        }
        function playScreech() {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(100, audioCtx.currentTime);
            osc.frequency.linearRampToValueAtTime(800, audioCtx.currentTime + 0.1);
            osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.2);
            
            const lfo = audioCtx.createOscillator();
            lfo.type = 'square';
            lfo.frequency.value = 25;
            const lfoGain = audioCtx.createGain();
            lfoGain.gain.value = 1000;
            lfo.connect(lfoGain);
            lfoGain.connect(osc.frequency);
            lfo.start();

            gain.gain.value = 0.5;
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start();
            oscillators.push(osc);
            oscillators.push(lfo);
        }
        function stopSound() {
            clearTimeout(heartInterval);
            oscillators.forEach(o => { try{o.stop();}catch(e){} });
        }

        // --- 3. CHAOS LOGIC ---
        function spawnChaosWindow() {
            const div = document.createElement('div');
            div.className = 'terminal-popup';
            const w = Math.floor(Math.random() * 300 + 200);
            const h = Math.floor(Math.random() * 150 + 50);
            const x = Math.floor(Math.random() * (window.innerWidth - w));
            const y = Math.floor(Math.random() * (window.innerHeight - h));
            div.style.width = w + 'px'; div.style.height = h + 'px';
            div.style.left = x + 'px'; div.style.top = y + 'px';
            const msgs = ["CRITICAL_PROCESS_DIED", "DELETING_SYSTEM_32", "OVERRIDE_FAILED", "FATAL_ERROR", "ROOT_ACCESS_GRANTED"];
            let content = "C:\\WIN\\SYS32> run.exe<br>";
            for(let i=0; i<4; i++) content += `> ${msgs[Math.floor(Math.random() * msgs.length)]}<br>`;
            div.innerHTML = content;
            document.body.appendChild(div);
            setTimeout(() => div.remove(), 150);
        }

        // --- 4. ENDING BG ANIMATION (NEURAL NETWORK) ---
        function startTechBg() {
            const c = document.getElementById('tech-bg-canvas');
            const cx = c.getContext('2d');
            c.width = window.innerWidth;
            c.height = window.innerHeight;
            let nodes = [];
            for(let i=0; i<50; i++) {
                nodes.push({
                    x: Math.random()*c.width, y: Math.random()*c.height,
                    vx: (Math.random()-0.5), vy: (Math.random()-0.5)
                });
            }
            function drawNodes() {
                cx.clearRect(0,0,c.width,c.height);
                cx.fillStyle = "#00ffcc";
                cx.strokeStyle = "rgba(0, 255, 204, 0.2)";
                for(let i=0; i<nodes.length; i++) {
                    let n = nodes[i];
                    n.x += n.vx; n.y += n.vy;
                    if(n.x<0||n.x>c.width) n.vx*=-1;
                    if(n.y<0||n.y>c.height) n.vy*=-1;
                    cx.beginPath(); cx.arc(n.x, n.y, 2, 0, Math.PI*2); cx.fill();
                    for(let j=i+1; j<nodes.length; j++) {
                        let n2 = nodes[j];
                        let dist = Math.hypot(n.x-n2.x, n.y-n2.y);
                        if(dist < 150) {
                            cx.beginPath(); cx.moveTo(n.x, n.y); cx.lineTo(n2.x, n2.y); cx.stroke();
                        }
                    }
                }
                requestAnimationFrame(drawNodes);
            }
            drawNodes();
        }

        // --- 5. SEQUENCER ---
        function startPrank() {
            startScreen.style.display = 'none';
            document.body.style.cursor = 'none';
            if(document.documentElement.requestFullscreen) document.documentElement.requestFullscreen();
            animateTunnel();
            startHeartbeat();
            setTimeout(() => { mainText.style.display = 'block'; recOverlay.style.display = 'block'; }, 2000);
            setTimeout(() => { ipDisplay.style.display = 'block'; ipDisplay.innerText = "TARGET LOCKED: 192.168.0.666"; }, 4000);
            setTimeout(() => { triggerScare(); }, 8000);
        }

        function triggerScare() {
            playScreech();
            document.body.classList.add('shaking-body');
            document.body.classList.add('strobe-bg');
            chaosInterval = setInterval(spawnChaosWindow, 40); 
            mainText.innerText = "SYSTEM FAILURE";
            mainText.style.fontSize = "6rem";
            ipDisplay.innerText = "DATA CORRUPTION IMMINENT";
            deleteContainer.style.display = 'block';
            let width = 0;
            deleteInterval = setInterval(() => {
                width++; deleteFill.style.width = width + "%"; if(width>100) width=0;
            }, 50);
        }

        document.addEventListener('keydown', (e) => {
            if(e.key === "Escape") {
                if(escapeCount === 0) {
                    escapeCount = 1; triggerScare(); mainText.innerText = "ESCAPE FAILED";
                } else {
                    showTechEnding();
                }
            }
        });

        document.addEventListener('fullscreenchange', () => {
            if (!document.fullscreenElement && escapeCount === 0) { escapeCount = 1; triggerScare(); }
        });

        function showTechEnding() {
            stopSound();
            cancelAnimationFrame(animationId);
            clearInterval(chaosInterval);
            clearInterval(deleteInterval);
            document.body.classList.remove('shaking-body');
            document.body.classList.remove('strobe-bg');
            document.getElementById('ui-layer').style.display = 'none';
            canvas.style.display = 'none';
            recOverlay.style.display = 'none';
            document.querySelectorAll('.terminal-popup').forEach(el => el.remove());

            // START TECH ENDING
            funnyLayer.style.display = 'flex';
            setTimeout(() => { funnyLayer.style.opacity = '1'; }, 50);
            document.body.style.cursor = 'auto';
            startTechBg();
        }

    </script>
</body>
</html>